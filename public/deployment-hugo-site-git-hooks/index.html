<!DOCTYPE html>
<html lang="es-mx">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.5.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="Luis Cacho">

  
  
  
    
  
  <meta name="description" content="Como realizar un deployment de un sitio con Hugo automaticamente usando Git Hooks">

  
  <link rel="alternate" hreflang="es-mx" href="/deployment-hugo-site-git-hooks/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.0/css/all.css" integrity="sha384-aOkxzJ5uQz7WBObEZcHvV5JvRW3TUc2rNPA7pe3AwnsUohiw1Vj2Rgx2KSOkF5+h" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" integrity="sha256-ygkqlh3CYSUri3LhQxzdcm0n1EQvH2Y+U5S2idbLtxs=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/railscasts.min.css" crossorigin="anonymous" title="hl-light">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/styles/railscasts.min.css" crossorigin="anonymous" title="hl-dark" disabled>
      
    

    

    
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/2.9.0/instantsearch.min.css" integrity="sha256-ZtmLe16p4jS4/2wPwwH6NzJt460SJzgLmhKrYo5yn7g=" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/2.10.2/instantsearch-theme-algolia.min.css" integrity="sha256-uL8LUd3zkI/lXvc/Hv/oOu8ld6RJcOZiUY/8c+I+3/o=" crossorigin="anonymous">
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  <link rel="stylesheet" href="/css/academic.min.1667586aff8d4e59d98ca91e327bdfbe.css">

  

  




  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/img/icon-32.png">
  <link rel="apple-touch-icon" type="image/png" href="/img/icon-192.png">

  <link rel="canonical" href="/deployment-hugo-site-git-hooks/">

  
  
  
  
    
  
  
  <meta property="twitter:card" content="summary_large_image">
  
  <meta property="twitter:site" content="@k4ch0">
  <meta property="twitter:creator" content="@k4ch0">
  
  <meta property="og:site_name" content="Luis Cacho">
  <meta property="og:url" content="/deployment-hugo-site-git-hooks/">
  <meta property="og:title" content="Deployment de un sitio estatico con Hugo y Git Hooks | Luis Cacho">
  <meta property="og:description" content="Como realizar un deployment de un sitio con Hugo automaticamente usando Git Hooks"><meta property="og:image" content="/deployment-hugo-site-git-hooks/featured.png">
  <meta property="twitter:image" content="/deployment-hugo-site-git-hooks/featured.png"><meta property="og:locale" content="es-mx">
  
    
      <meta property="article:published_time" content="2018-03-05T11:35:56-06:00">
    
    <meta property="article:modified_time" content="2019-11-17T11:35:56-06:00">
  

  


    






  






<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "/deployment-hugo-site-git-hooks/"
  },
  "headline": "Deployment de un sitio estatico con Hugo y Git Hooks",
  
  "image": [
    "/deployment-hugo-site-git-hooks/featured.png"
  ],
  
  "datePublished": "2018-03-05T11:35:56-06:00",
  "dateModified": "2019-11-17T11:35:56-06:00",
  
  "author": {
    "@type": "Person",
    "name": "Luis Cacho"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Luis Cacho",
    "logo": {
      "@type": "ImageObject",
      "url": "/img/lc-profile.png"
    }
  },
  "description": "Como realizar un deployment de un sitio con Hugo automaticamente usando Git Hooks"
}
</script>

  

  


  


  





  <title>Deployment de un sitio estatico con Hugo y Git Hooks | Luis Cacho</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Buscar</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  
<nav class="navbar navbar-light fixed-top navbar-expand-lg py-0 compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
      <a class="navbar-brand" href="/"><img src="/img/lc-profile.png" alt="Luis Cacho"></a>
      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Barra de navegación">
        <span><i class="fas fa-bars"></i></span>
      </button>
      

    
    <div class="collapse navbar-collapse" id="navbar">

      
      
      <ul class="navbar-nav ml-auto">
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#about"><span>Inicio</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#posts"><span>Posts</span></a>
        </li>

        
        

        
        <li class="nav-item dropdown">
          <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown" aria-haspopup="true"><span>Experiencia</span><span class="caret"></span>
          </a>
          <ul class="dropdown-menu">
            
            <li class="dropdown-item my-0 py-0 mx-0 px-0">
              <a href="/#experience"><span>Experiencia</span></a>
            </li>
            
            <li class="dropdown-item my-0 py-0 mx-0 px-0">
              <a href="/#certifications"><span>Certificaciones</span></a>
            </li>
            
            <li class="dropdown-item my-0 py-0 mx-0 px-0">
              <a href="/#training"><span>Cursos</span></a>
            </li>
            
            <li class="dropdown-item my-0 py-0 mx-0 px-0">
              <a href="/files/resume.pdf"><span>Currículo</span></a>
            </li>
            
          </ul>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/#projects"><span>Projectos</span></a>
        </li>

        
        

      

        

        
        <li class="nav-item">
          <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
        </li>
        

        

        
        <li class="nav-item">
          <a class="nav-link js-dark-toggle" href="#"><i class="fas fa-moon" aria-hidden="true"></i></a>
        </li>
        

      </ul>

    </div>
  </div>
</nav>


  <article class="article">

  




















  
  
    
  


<div class="article-container pt-3">
  <h1>Deployment de un sitio estatico con Hugo y Git Hooks</h1>

  
  <p class="page-subtitle">Como realizar un deployment de un sitio con Hugo automaticamente usando Git Hooks</p>
  

  



<div class="article-metadata">

  
  
  
  
  <div>
    



  
  <span><a href="/authors/admin/">Luis Cacho</a></span>

  </div>
  
  

  
  <span class="article-date">
    
    
      
          Última actualización el
      
    
    Nov 17, 2019
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    8 min de lectura
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/categories/linux/">Linux</a>, <a href="/categories/sysadmin/">SysAdmin</a>, <a href="/categories/devops/">DevOps</a>, <a href="/categories/open-source/">Open Source</a></span>
  

  
    
<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=/deployment-hugo-site-git-hooks/&amp;text=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=/deployment-hugo-site-git-hooks/&amp;t=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook-f"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks&amp;body=/deployment-hugo-site-git-hooks/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=/deployment-hugo-site-git-hooks/&amp;title=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks%20/deployment-hugo-site-git-hooks/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=/deployment-hugo-site-git-hooks/&amp;title=Deployment%20de%20un%20sitio%20estatico%20con%20Hugo%20y%20Git%20Hooks" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>


  

</div>

  














</div>


<div class="article-header article-container featured-image-wrapper mt-4 mb-4" style="max-width: 720px; max-height: 281px;">
  <div style="position: relative">
    <img src="/deployment-hugo-site-git-hooks/featured_hufa463b7853bbccf5d439b84abeff6adf_56523_720x0_resize_lanczos_2.png" alt="" class="featured-image">
    
  </div>
</div>



  <div class="article-container">

    <div class="article-style">
      

<p><h2>Índice</h2>
<nav id="TableOfContents">
<ul>
<li><a href="#1-motivación">1. Motivación</a>
<ul>
<li><a href="#1-1-consideraciones">1.1 Consideraciones</a></li>
</ul></li>
<li><a href="#2-instruciones">2. Instruciones</a>
<ul>
<li><a href="#2-1-consideraciones-técnicas">2.1 Consideraciones técnicas</a></li>
<li><a href="#2-2-autenticación-mediante-llaves-ssh">2.2 Autenticación mediante llaves SSH</a></li>
<li><a href="#2-3-configuración-sitio-con-hugo">2.3 Configuración sitio con Hugo</a></li>
<li><a href="#2-4-configuración-del-repositorio-git-en-el-servidor-de-desarrollo-1ra-parte">2.4 Configuración del repositorio Git en el servidor de desarrollo 1ra parte</a></li>
<li><a href="#2-5-configuración-del-repositorio-git-en-el-servidor-productivo">2.5 Configuración del repositorio Git en el servidor productivo</a>
<ul>
<li><a href="#2-5-1-configuración-del-hook">2.5.1 Configuración del hook</a></li>
</ul></li>
<li><a href="#2-6-configuración-del-repositorio-git-en-el-servidor-de-desarrollo-2da-parte">2.6 Configuración del repositorio Git en el servidor de desarrollo 2da parte</a></li>
</ul></li>
</ul>
</nav></p>

<h1 id="1-motivación">1. Motivación</h1>

<p>Estoy intentando escribir un poco más en mi blog, ya que noté que muchas veces no lo hacia muy a menudo por que al llegar a la consola de administración de Wordpress, habia que dar bastantes clicks para llegar al menu de &ldquo;Posts&rdquo;, además de que cada vez que entraba había un plugin diferente que actualizar, y verificar que nada se rompiera con las nuevas actualizaciónes, en pocas palabras hay que darle bastante mantenimiento a un sitio con Wordpress, y además de eso había que dedicarse a escribir el post.</p>

<p>Otra razón por lo que opté hacer el cambio de plataforma, es que al estar tratando de convertirme en DevOps, es necesario, desde mi punto de vista; tratar automatizar/scriptear la mayoria de tus tareas que realizas día a día, y con <a href="https://gohugo.io/" title="Hugo" target="_blank">Hugo</a> considero que se puede realizar este objetivo también.</p>

<h2 id="1-1-consideraciones">1.1 Consideraciones</h2>

<p>Una vez que decidí migrarme de Wordpress, el siguiente paso era decidir a que plataforma mudarme.
De entrada la plataforma que queria probar era un <a href="https://en.wikipedia.org/wiki/Static_web_page" target="_blank">Static Site Generator</a>, aqui otro <a href="https://learn.cloudcannon.com/jekyll/why-use-a-static-site-generator/" target="_blank">link</a> de por que usar un Static Site Generator.</p>

<p>Partiendo de lo anterior, las opciones que me parecieron interesantes fueron:</p>

<ul>
<li><a href="https://gohugo.io" title="Hugo" target="_blank">Hugo</a></li>
<li><a href="https://jekyllrb.com" title="Jekyll" target="_blank">Jekyll</a></li>
<li><a href="http://octopress.org/" title="Octopress" target="_blank">Octopress</a></li>
<li><a href="https://hexo.io/" title="Hexo" target="_blank">Hexo</a></li>
</ul>

<p>Cada una de las opciones tiene diferentes caracteristicas, que no vamos a discutir en este post, sin embargo las carteristicas que me convencieron de usar <a href="https://gohugo.io/" title="Hugo" target="_blank">Hugo</a> por encima de las otras alternativas fueron:</p>

<ul>
<li>Consta solamente de un binario, que comparado con las otras posibilidades hay que instalar todo un ambiente de desarrollo/producción.</li>
<li>Es bastante rápido.</li>
<li>Es Multi-plataforma</li>
<li>Tiene diversos <a href="https://themes.gohugo.io/" target="_blank">temas</a></li>
</ul>

<h1 id="2-instruciones">2. Instruciones</h1>

<h2 id="2-1-consideraciones-técnicas">2.1 Consideraciones técnicas</h2>

<p>El ambiente consta de:</p>

<ul>
<li>1 servidor productivo donde esta instalado hugo, git y un servidor web (apache o nginx) , haremos todos los deployments usando el usuario admin, ojo que no es el usuario root.</li>
<li>1 servidor/equipo de desarrollo, de igual forma que cuenta con hugo y git, en mi caso, es mi computadora personal y mi usuario es luiscachog.</li>
<li>1 cuenta de <a href="https://github.com" target="_blank">github.com</a></li>
</ul>

<h2 id="2-2-autenticación-mediante-llaves-ssh">2.2 Autenticación mediante llaves SSH</h2>

<p>El primer paso es realizar el intercambio de llaves SSH entre el equipo de desarrollo y el equipo productivo. Para ello seguimos los siguientes pasos:</p>

<ol>
<li><p>Generar la llave SSH, tendrás que contestar algunas preguntas, entre las cuales está si quieres ponerle un password, a lo cual deberas dejarlo en blanco para que no te pida contraseña.</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ ssh-keygen
</code></pre></li>

<li><p>Copiar la llave SSH hacia el equipo productivo:</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ ssh-copy-id admin@IP_servidor_productivo
</code></pre></li>

<li><p>Verificar que te puedas conectar desde tu servidor de desarrollo, con tu usuario al servidor productivo, con el usuario que realizará los deployments.</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ ssh admin@162.125.2.30 hostname
</code></pre>

<p>En este caso, debera de mostrarte el hostname del servidor productivo sin pedirte el password.</p></li>
</ol>

<h2 id="2-3-configuración-sitio-con-hugo">2.3 Configuración sitio con Hugo</h2>

<p>El siguiente paso es configurar nuestro ambiente de desarrollo con Hugo y Git.</p>

<ol>
<li><p>Para instalar ambos en Ubuntu o derivados debes de ejecutar:</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ sudo apt install hugo git
</code></pre>

<p>Para tener la version más actualizada de hugo puedes seguir los pasos descritos en este <a href="https://gohugo.io/getting-started/installing/" target="_blank">link</a></p></li>

<li><p>Vamos a crear un directorio de trabajo para nuestro sitio estatico</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ mkdir ~/sites
luiscachog@dev-server:~$ cd ~/sites
</code></pre></li>

<li><p>Crearemos un nuevo sitio usando el comando hugo</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ hugo new site luiscachog.io
Congratulations! Your new Hugo site is created in /home/luiscachog/sites/luiscachog.io.

Just a few more steps and you're ready to go:

1.- Download a theme into the same-named folder.
    Choose a theme from https://themes.gohugo.io/, or
    create your own with the &quot;hugo new theme &lt;THEMENAME&gt;&quot; command.
2.- Perhaps you want to add some content. You can add single files
    with &quot;hugo new &lt;SECTIONNAME&gt;/&lt;FILENAME&gt;.&lt;FORMAT&gt;&quot;.
3.- Start the built-in live server via &quot;hugo server&quot;.

Visit https://gohugo.io/ for quickstart guide and full documentation.
</code></pre></li>

<li><p>Cuando termine de correr el comando se podra apreciar los siguientes directorios y archivos</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ cd luiscachog.io
luiscachog@dev-server:~$ ls
archetypes  config.toml  content  data  layouts  static  themes
luiscachog@dev-server:~$ tree 
.
├── archetypes
│   └── default.md
├── config.toml
├── content
├── data
├── layouts
├── static
└── themes

6 directories, 2 files
</code></pre></li>

<li><p>El siguiente paso es agregar un tema, puedes encontrar uno que te guste en <a href="https://themes.gohugo.io/" target="_blank">https://themes.gohugo.io/</a></p>

<pre><code class="language-shell">git init
git submodule add https://github.com/budparr/gohugo-theme-ananke.git themes/ananke

# Edit your config.toml configuration file
# and add the new theme.

echo 'theme = &quot;ananke&quot;' &gt;&gt; config.toml
</code></pre>

<p>Como recomendación adicional en este paso, puedes realizar un fork del tema que te guste en github para poder realizar modificaciones y proponer cambios al mismo, contribuyendo de esa forma a su desarrollo, para hacerlo, sigue los pasos:</p>

<ol>
<li>Realizar un fork del tema, sigue esta <a href="https://guides.github.com/activities/forking/" target="_blank">guia</a> para hacerlo.</li>

<li><p>Al realizar el fork, tendras en tus repositorios de github el tema que quieras, por lo que tendras que ejecutar los mismos comandos del punto anterior, pero el repositorio del tema apuntara a tu usario en github</p>

<pre><code class="language-shell">git init
git submodule add https://github.com/k4ch0/gohugo-theme-ananke.git themes/ananke
# Edit your config.toml configuration file
# and add the new theme.

echo 'theme = &quot;ananke&quot;' &gt;&gt; config.toml
</code></pre></li>
</ol></li>

<li><p>Vamos a crear un post de prueba para verificar que todo esta funcionando correctamente</p>

<pre><code class="language-shell">hugo new posts/my-first-post.md
echo &quot;Hola Mundo&quot; &gt;&gt; content/posts/my-first-post.md
</code></pre>

<p>El comando anterior creara un archivo en la ruta content/posts/my-first-post.md, y el contenido será:</p>

<pre><code class="language-yaml">---
title: &quot;My First Post&quot;
date: 2018-02-28T12:02:38-06:00
draft: true
---
Hola Mundo!!!

</code></pre></li>

<li><p>Finalmente, probaremos que nuestro sitio estatico con nuestro post se muestren de manera local, en nuestro servidor de desarrollo.
Cabe mencionar, que por defecto el comando &lsquo;hugo server&rsquo; no mostrará los posts que tengan la opción &lsquo;draft: true&rsquo;, por ello se agrega la bandera -D</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ hugo server -D
</code></pre></li>
</ol>

<h2 id="2-4-configuración-del-repositorio-git-en-el-servidor-de-desarrollo-1ra-parte">2.4 Configuración del repositorio Git en el servidor de desarrollo 1ra parte</h2>

<p>En el paso pasado, realizamos la inicialización del repositorio dentro del directorio del sitio estatico:</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ pwd
/home/luiscachog/sites/luiscachog.io
luiscachog@dev-server:~$ git status
On branch master

Initial commit

Changes to be committed:
  (use &quot;git rm --cached &lt;file&gt;...&quot; to unstage)

    new file:   .gitmodules
    new file:   themes/ananke

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)

    archetypes/
    config.toml
    content/
    themes/ananke/
</code></pre>

<p>Ahora, para tener el repositorio publico, tenemos que <a href="https://help.github.com/articles/creating-a-new-repository/" target="_blank">crear</a> el repositorio en <a href="https://github.com" target="_blank">github.com</a> y configurarlo como un repositorio remoto</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ git add *
luiscachog@dev-server:~$ git commit -m &quot;First commit&quot;
luiscachog@dev-server:~$ git remote add origin https://github.com/k4ch0/luiscachog.io
luiscachog@dev-server:~$ git push -u origin master
</code></pre>

<h2 id="2-5-configuración-del-repositorio-git-en-el-servidor-productivo">2.5 Configuración del repositorio Git en el servidor productivo</h2>

<p>Para poder ocupar los hooks de git es necesario hacer una primera copia inicial del repositorio en el que vamos a trabajar, con la particularidad de que el repositorio clonado debe ser del tipo <a href="http://www.saintsjd.com/2011/01/what-is-a-bare-git-repository/" target="_blank">bare</a>.</p>

<p>En nuestro servidor productivo haremos:</p>

<pre><code class="language-shell">admin@prod-server:~$ mkdir sites
admin@prod-server:~$ cd sites
admin@prod-server:~$ git clone --bare https://github.com/k4ch0/luiscachog.io  luiscachog.io.git
</code></pre>

<h3 id="2-5-1-configuración-del-hook">2.5.1 Configuración del hook</h3>

<ol>
<li><p>Ya que tenemos nuestro repositorio tipo bare en el servidor productivo vamos a crear el script que mandará a llamar el hook de git.</p>

<pre><code class="language-shell">admin@prod-server:~$ cd sites/luiscachog.io.git/hooks
admin@prod-server:~$ vim post-update
</code></pre></li>

<li><p>Y agregamos algo asi:</p>

<pre><code class="language-shell">#!/bin/bash

GIT_REPO=$HOME/luiscachog.io.git
WORKING_DIRECTORY=/var/www/vhosts/luiscachog.io/working_hugo
PUBLIC_WWW=/var/www/vhosts/luiscachog.io/public_html
BACKUP_WWW=/var/www/vhosts/luiscachog.io/backup_html
MY_DOMAIN=luiscachog.io

set -e

rm -rf $WORKING_DIRECTORY
rsync -aqz $PUBLIC_WWW/ $BACKUP_WWW
trap &quot;echo 'A problem occurred.  Reverting to backup.'; rsync -aqz --del $BACKUP_WWW/ $PUBLIC_WWW; rm -rf $WORKING_DIRECTORY&quot; EXIT

git clone $GIT_REPO $WORKING_DIRECTORY
mkdir -p $WORKING_DIRECTORY/themes
rm -rf $PUBLIC_WWW/*
/home/admin/bin/hugo -v -s $WORKING_DIRECTORY -d $PUBLIC_WWW -b &quot;http://${MY_DOMAIN}&quot;
trap - EXIT
</code></pre></li>

<li><p>Damos permisos de ejecución al script</p>

<pre><code class="language-shell">admin@prod-server:~$ chmod +x post-update
</code></pre></li>

<li><p>Probamos que nuestro script funcione adecuadamente:</p>

<pre><code class="language-shell">admin@prod-server:~$ ~/sites/luiscachog.io.git/hooks/post-update

Cloning into '/var/www/vhosts/luiscachog.io/working_hugo'...
done.
0 draft content
0 future content 
4 pages created
0 paginator pages created
0 tags created
1 categories created
in 26 ms
</code></pre></li>

<li><p>Podras verificar tu nuevo post en la URL de su sitio:</p>

<pre><code class="language-shell">http://production_domain_or_IP
</code></pre></li>
</ol>

<h2 id="2-6-configuración-del-repositorio-git-en-el-servidor-de-desarrollo-2da-parte">2.6 Configuración del repositorio Git en el servidor de desarrollo 2da parte</h2>

<p>Una vez tenemos configurado nuestro repositorio en el servidor de producción, procedemos a agregarlo como repositorio remoto en nuestro servidor de desarrollo</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ cd /home/luiscachog/sites/luiscachog.io
luiscachog@dev-server:~$ git remote add prod admin@IP_servidor_productivo:luiscachog.io
luiscachog@dev-server:~$ git ls-remote prod
d1b0b73528ab3117170ef74e133d0194dd2bc88a    HEAD
d1b0b73528ab3117170ef74e133d0194dd2bc88a    refs/heads/master
</code></pre>

<p>Puedes verificar los repositorios remotos con el comando:</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ git remote -v
origin  git@github.com:k4ch0/luiscachog.io.git (fetch)
origin  git@github.com:k4ch0/luiscachog.io.git (push)
prod    admin@IP_servidor_productivo:luiscachog.io.git (fetch)
prod    admin@IP_servidor_productivo:luiscachog.io.git (push)
</code></pre>

<p>Ahora cada vez que realizemos un push hacia el remote llamado &lsquo;prod&rsquo; se llamara la función del hook.</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ cd /home/luiscachog/sites/luiscachog.io
luiscachog@dev-server:~$ hugo new posts/Testing-Deployment.md
luiscachog@dev-server:~$ echo &quot;Deployment Test&quot; &gt;&gt; content/posts/Testing-Deployment.md
luiscachog@dev-server:~$ git add *
luiscachog@dev-server:~$ git commit -m 'Deployment test with git hooks'
</code></pre>

<p>Este es el comando que hace la magia:</p>

<pre><code class="language-shell">luiscachog@dev-server:~$ git push prod master
Counting objects: 3, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (3/3), done.
Writing objects: 100% (3/3), 310 bytes | 0 bytes/s, done.
Total 3 (delta 2), reused 0 (delta 0)
remote: Cloning into '/var/www/vhosts/luiscachog.io/working_hugo'...
remote: done.
remote: Cloning into '/var/www/vhosts/luiscachog.io/working_hugo/themes/hugo-future-imperfect'...
remote: INFO 2018/03/01 03:12:34 Using config file: /var/www/vhosts/luiscachog.io/working_hugo/config.toml
remote: Building sites … INFO 2018/03/01 03:12:34 syncing static files to /var/www/vhosts/luiscachog.io/public_html/
remote: 
remote:                    | EN  
remote: +------------------+----+
remote:   Pages            | 10
remote:   Paginator pages  |  0  
remote:   Non-page files   |  0  
remote:   Static files     |  3  
remote:   Processed images |  0  
remote:   Aliases          |  1  
remote:   Sitemaps         |  1  
remote:   Cleaned          |  0  
remote: 
remote: Total in 44 ms
To admin@IP_servidor_productivo:luiscachog.io.git
   d5b0671..cvc4dee  master -&gt; master
</code></pre>

<p>Listo ya podemos probar nuestro sitio</p>

<pre><code class="language-shell">http://luiscachog.io
</code></pre>

<p>Con esto el siguiente paso que realizare es hacer el deployment de mi servidor para el blog usando Ansible.</p>

<p>Nos Vemos!!!</p>

<p>Sources:
<a href="https://www.digitalocean.com/community/tutorials/how-to-deploy-a-hugo-site-to-production-with-git-hooks-on-ubuntu-14-04" target="_blank">Digital Ocean</a></p>

    </div>

    


    

<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/hugo/">Hugo</a>
  
  <a class="badge badge-light" href="/tags/git/">Git</a>
  
  <a class="badge badge-light" href="/tags/open-source/">Open Source</a>
  
</div>



    
      








  
  
    
  
  






  
  
  
    
  
  
  <div class="media author-card">
    
      <img class="portrait mr-3" src="https://s.gravatar.com/avatar/c9ee399aeb97703a47fb72bc9555ad4f?s=200')" alt="Avatar">
    

    <div class="media-body">
      <h5 class="card-title"><a href="/">Luis Cacho</a></h5>
      <h6 class="card-subtitle">Linux Administrator III</h6>
      <p class="card-text">bio test</p>
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
    <li>
      <a href="mailto:luiscachog@gmail.com" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-github-alt"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-gitlab"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-goodreads"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://keybase.io/luiscachog" target="_blank" rel="noopener">
        <i class="fab fa-keybase"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-lastfm"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-linkedin-in"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-linux"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-medium-m"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-meetup"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-python"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-reddit-alien"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-redhat"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-stack-overflow"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://gitlab.com/k4ch0" target="_blank" rel="noopener">
        <i class="fab fa-ubuntu"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/files/resume.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>



      
      
    

    
    <div class="article-widget">
      
<div class="post-nav">
  
  
  
  <div class="post-nav-item">
    <div class="meta-nav">Anterior</div>
    <a href="/post/im-a-racker/" rel="prev">Soy un Racker</a>
  </div>
  
</div>

    </div>
    

    


  </div>
</article>

      

    
    

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" integrity="sha256-X5PoE3KU5l+JcX+w09p/wHl9AzK333C4hJ2I9S5mD4M=" crossorigin="anonymous"></script>

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.0.0/mermaid.min.js" integrity="sha256-0w92bcB21IY5+rGI84MGj52jNfHNbXVeQLrZ0CGdjNY=" crossorigin="anonymous" title="mermaid"></script>
      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/highlight.min.js" integrity="sha256-aYTdUrn6Ow1DDgh5JTc3aDGnnju48y/1c8s1dgkYPQ8=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/yaml.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/shell.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.6/languages/python.min.js"></script>
        
      

      
      
    

    
    

    
    
    <script>hljs.initHighlightingOnLoad();</script>
    

    
    
    <script>
      const search_index_filename = "/index.json";
      const i18n = {
        'placeholder': "Buscar...",
        'results': "resultados encontrados",
        'no_results': "No se encontraron resultados"
      };
      const content_type = {
        'post': "Posts",
        'project': "Proyectos",
        'publication' : "Publicaciones",
        'talk' : "Charlas"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-algolia-template" type="text/html">
      <div class="search-hit">
        <div class="search-hit-content">
          <div class="search-hit-name">
            <a href="{{relpermalink}}">{{{_highlightResult.title.value}}}</a>
          </div>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{{_highlightResult.summary.value}}}</p>
        </div>
      </div>
    </script>
    

    
    

    
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/instantsearch.js/2.10.2/instantsearch.min.js" integrity="sha256-gFCtPk/sonctyfwYOgjrPoWApQ0rqB6ezBBZ7p32yGc=" crossorigin="anonymous"></script>
    
    <script>
      const algoliaConfig = {
        appId: "NZ0TX11BPQ",
        apiKey: "7e1b9fab0c463868d3b052d504ba35dc",
        indexName: "luiscachog.io",
        poweredBy:  false 
      };
    </script>
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/js/academic.min.99deeb15393fea075138a921b6b3436e.js"></script>

    






  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    &copy; 2019 &middot; 

    Powered by the
    <a href="https://sourcethemes.com/academic/" target="_blank" rel="noopener">Academic theme</a> for
    <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>.

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Citar</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copiar
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Descargar
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
