<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cloud | Luis Cacho</title>
    <link>/en/categories/cloud/</link>
      <atom:link href="/en/categories/cloud/index.xml" rel="self" type="application/rss+xml" />
    <description>Cloud</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>Â© 2019</copyright><lastBuildDate>Fri, 13 Feb 2015 02:08:44 -0500</lastBuildDate>
    <image>
      <url>/img/lc-profile.png</url>
      <title>Cloud</title>
      <link>/en/categories/cloud/</link>
    </image>
    
    <item>
      <title>View sources IP&#39;s in Apache Logs behind a Load Balancer</title>
      <link>/view-sources-ips-apache-logs-behind-loadbalancer/</link>
      <pubDate>Fri, 13 Feb 2015 02:08:44 -0500</pubDate>
      <guid>/view-sources-ips-apache-logs-behind-loadbalancer/</guid>
      <description>&lt;p&gt;When you use the Rackspace Cloud Load Balancers, it is common that the IP logged in Apache is the Private IP (ServiceNet) from the Cloud Load Balancer, however, we can fix that.&lt;/p&gt;

&lt;p&gt;We can view sources IP&amp;rsquo;s in Apache Logs doing some changes on Apache configuration file and also on the vhosts configuration files.&lt;/p&gt;

&lt;p&gt;On your Apache configuration file, you should to find the line:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;LogFormat &amp;quot;%h %l %u %t \&amp;quot;%r\&amp;quot; %&amp;amp;gt;s %b \&amp;quot;%{Referer}i\&amp;quot; \&amp;quot;%{User-Agent}i\&amp;quot;&amp;quot; combined
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Modified to:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;LogFormat &amp;quot;%{X-Forwarded-For}i %h %l %u %t \&amp;quot;%r\&amp;quot; %&amp;amp;gt;s %O \&amp;quot;%{Referer}i\&amp;quot; \&amp;quot;%{User-Agent}i\&amp;quot;&amp;quot; combined
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And also, on your vhosts configuration files you should to change the &amp;ldquo;combined&amp;rdquo; LogFormat definition will then be called in a &amp;ldquo;CustomLog&amp;rdquo; entry specific to your VirtualHost configuration. Here is an example VirtualHost definition to show you what I&amp;rsquo;m referring to:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-shell&#34;&gt;ServerAdmin webmaster@example.com
DocumentRoot /var/www/html/example.com
ServerName example.com
ErrorLog logs/example.com-error_log
CustomLog logs/example.com-access_log combined
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After adding the X-Forwarded-For definition to the LogFormat definition, you can restart Apache and view the logs to notice the difference. If all is done properly, you will see an actual public IP in the first field of your logs instead of the Cloud Load Balancer IP.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
